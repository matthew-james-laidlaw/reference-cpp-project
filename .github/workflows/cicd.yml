name: cicd

on: [ push, pull_request, workflow_dispatch ]

jobs:
  build:
    name: ${{ matrix.name }}
    strategy:
      fail-fast: false
      matrix:
        include:
          - { name: arm64-apple-clang, runs_on: macos-latest   }
          - { name: x64-linux-clang,   runs_on: ubuntu-latest  }
          - { name: x64-linux-gnu,     runs_on: ubuntu-latest  }
          - { name: x64-windows-msvc,  runs_on: windows-latest }
          - { name: x64-windows-clang, runs_on: windows-latest }

    runs-on: ${{ matrix.runs_on }}

    steps:
      - uses: actions/checkout@v4
      - name: Configure & build (${{ matrix.name }})
        run: |
          cmake --preset ${{ matrix.name }}
          cmake --build --preset ${{ matrix.name }}
          ctest --preset ${{ matrix.name }}
